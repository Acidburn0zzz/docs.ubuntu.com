<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Juju Quick Start &mdash; MAAS 1.9 documentation</title>
    
    <link rel="stylesheet" href="/static/maas-1.9/flasky.css" type="text/css" />
    <link rel="stylesheet" href="/static/maas-1.9/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://assets.ubuntu.com/sites/guidelines/css/latest/ubuntu-styles.css" type="text/css" />
    <link rel="stylesheet" href="https://assets.ubuntu.com/sites/ubuntu/latest/u/css/global.css" type="text/css" />
    <link rel="stylesheet" href="/static/maas-1.9/css/main.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="/static/maas-1.9/jquery.js"></script>
    <script type="text/javascript" src="/static/maas-1.9/underscore.js"></script>
    <script type="text/javascript" src="/static/maas-1.9/doctools.js"></script>
    <link rel="shortcut icon" href="/static/maas-1.9/maas.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="MAAS 1.9 documentation" href="index.html" />
    <link rel="next" title="Making use of Tags" href="tags.html" />
    <link rel="prev" title="Devices" href="devices.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tags.html" title="Making use of Tags"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="devices.html" title="Devices"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="/maas/">Latest documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
  </li>
  <li class="nav-item nav-item-0">
    <a href="index.html">MAAS 1.9 documentation</a>
  </li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="juju-quick-start">
<h1>Juju Quick Start<a class="headerlink" href="juju-quick-start.html#juju-quick-start" title="Permalink to this headline">¶</a></h1>
<p>These instructions will help you deploy your first charm with Juju to
a MAAS cluster.</p>
<p>In the following, we assume that you have a MAAS cluster set-up with at least
2 nodes enlisted with it.</p>
<div class="section" id="your-api-key-ssh-key-and-environments-yaml">
<h2>Your API key, SSH key, and environments.yaml<a class="headerlink" href="juju-quick-start.html#your-api-key-ssh-key-and-environments-yaml" title="Permalink to this headline">¶</a></h2>
<p>You&#8217;ll need an API key from MAAS so that the Juju client can access
it. Each user account in MAAS can have as many API keys as desired.
One hard and fast rule is that you&#8217;ll need to use a different API key
for each Juju <em>environment</em> you set up within a single MAAS cluster.</p>
<p>There is no need to explicitly add an SSH key to MAAS when using Juju;
it will automatically put your public key on any hosts that it starts up.</p>
<p><strong>Note</strong>: You do not need to use the MAAS web UI or API to allocate
a node to yourself, Juju will do this for you.</p>
<div class="section" id="getting-a-key">
<h3>Getting a key<a class="headerlink" href="juju-quick-start.html#getting-a-key" title="Permalink to this headline">¶</a></h3>
<p>To get the API key:</p>
<ol class="arabic simple">
<li>Go to your MAAS preferences page (go to your MAAS home page
<code class="docutils literal"><span class="pre">http://${my-maas-server}:80/MAAS/</span></code> and choose <em>Preferences</em> from the
drop-down menu that appears when clicking your username at the top-right
of the page).</li>
<li>Optionally add a new MAAS key. Do this if you&#8217;re setting up another
environment within the same MAAS cluster.</li>
</ol>
<p>The <code class="docutils literal"><span class="pre">${my-maas-server}</span></code> slot should be replaced with the hostname of your
MAAS server.</p>
</div>
<div class="section" id="adding-an-ssh-key">
<h3>Adding an SSH key<a class="headerlink" href="juju-quick-start.html#adding-an-ssh-key" title="Permalink to this headline">¶</a></h3>
<p>While you&#8217;re still on the MAAS preferences page, add your SSH key
by clicking <em>Add SSH key</em>. Use the public half of your SSH key, the
content of <code class="docutils literal"><span class="pre">~/.ssh/id_rsa.pub</span></code> for example; don&#8217;t paste the private
half.</p>
</div>
<div class="section" id="creating-environments-yaml">
<h3>Creating environments.yaml<a class="headerlink" href="juju-quick-start.html#creating-environments-yaml" title="Permalink to this headline">¶</a></h3>
<p>Create or modify <code class="docutils literal"><span class="pre">~/.juju/environments.yaml</span></code> with the following content:</p>
<div class="highlight-python"><div class="highlight"><pre>environments:
  maas:
    type: maas
    maas-server: &#39;http://${my-maas-server}:80/MAAS&#39;
    maas-oauth: &#39;${maas-api-key}&#39;
    admin-secret: ${your-admin-secret}
    default-series: precise
</pre></div>
</div>
<p>Substitute the API key from earlier into the <code class="docutils literal"><span class="pre">${maas-api-key}</span></code>
slot, and the hostname of your MAAS server into the <code class="docutils literal"><span class="pre">${my-maas-server}</span></code>
slot.</p>
<p>The <code class="docutils literal"><span class="pre">${your-admin-secret}</span></code> slot should be replaced with a random pass-phrase,
there is no default.</p>
</div>
</div>
<div class="section" id="now-juju">
<h2>Now Juju<a class="headerlink" href="juju-quick-start.html#now-juju" title="Permalink to this headline">¶</a></h2>
<p>If juju-core is not yet installed on the client machine, run:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo apt-get install juju-core
</pre></div>
</div>
<p>Now, use juju to display the status of the default environment:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju status
</pre></div>
</div>
<p>As you&#8217;ve not bootstrapped you ought to see:</p>
<div class="highlight-python"><div class="highlight"><pre>error: Unable to connect to environment &quot;&quot;.
Please check your credentials or use &#39;juju bootstrap&#39; to create a new environment.
</pre></div>
</div>
<p><strong>Note</strong>: if Juju complains that there are multiple environments and
no explicit default, add <code class="docutils literal"><span class="pre">-e</span> <span class="pre">${environment-name}</span></code> after each
command, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju status -e maas
</pre></div>
</div>
<p>Bootstrap:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju sync-tools
$ juju bootstrap
</pre></div>
</div>
<p>If bootstrapping on a version of juju older than 1.14.0 then use:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju bootstrap --upload-tools
</pre></div>
</div>
<p>This will return quickly, but the master node may take a <em>long</em> time
to come up. It has to completely install Ubuntu and Juju on it and
reboot before it&#8217;ll be available for use. It&#8217;s probably worth either
trying a <code class="docutils literal"><span class="pre">juju</span> <span class="pre">status</span></code> once in a while to check on progress, or
following the install on the node directly.</p>
<blockquote>
<div><strong>Beware</strong> of <a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/console-setup/+bug/413415">bug 413415</a> - <em>console-setup hangs under chroot
debootstrap with a console login on ttyX</em> - when monitoring an
installation on the node.</div></blockquote>
<p>Once the boostrap node has been installed a status command should
come up with something a bit more interesting:</p>
<div class="highlight-python"><div class="highlight"><pre>environment: maas
machines:
  &quot;0&quot;:
    agent-state: started
    agent-version: 1.13.3.1
    dns-name: kmhwd.master
    instance-id: /MAAS/api/1.0/nodes/node-5c5b713a-1afc-11e3-9904-525400123456/
    series: precise
services: {}
</pre></div>
</div>
<p>Now it&#8217;s possible to deploy a charm:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju deploy mysql
$ juju status
</pre></div>
</div>
<p>If you have another node free you can finish off the canonical and by
now familiar example:</p>
<div class="highlight-python"><div class="highlight"><pre>$ juju deploy wordpress
$ juju add-relation wordpress mysql
$ juju expose wordpress
$ juju status
</pre></div>
</div>
<p>Note that each charm runs on its own host, so each deployment will
actually take as long as it took to bootstrap. Have a beer, drown your
sorrows in liquor, or, my preference, have another cup of tea.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<a style="border:0" title="MAAS Documentation Homepage" href="index.html"><img src="/static/maas-1.9/maas-logo-200.png" alt="MAAS logo"/></a>
<h2 style="text-align:center;">MAAS</h2>
<p style="font-style:italic;font-size:0.9em; text-align:center; margin-bottom:1.5em">Metal As A Service.</p>
<span id="version_switcher"></span>
<br/>
<br/>

  <ul>
<li><a class="reference internal" href="juju-quick-start.html#">Juju Quick Start</a><ul>
<li><a class="reference internal" href="juju-quick-start.html#your-api-key-ssh-key-and-environments-yaml">Your API key, SSH key, and environments.yaml</a><ul>
<li><a class="reference internal" href="juju-quick-start.html#getting-a-key">Getting a key</a></li>
<li><a class="reference internal" href="juju-quick-start.html#adding-an-ssh-key">Adding an SSH key</a></li>
<li><a class="reference internal" href="juju-quick-start.html#creating-environments-yaml">Creating environments.yaml</a></li>
</ul>
</li>
<li><a class="reference internal" href="juju-quick-start.html#now-juju">Now Juju</a></li>
</ul>
</li>
</ul>
<script type="text/javascript">
$(document).ready(function () {
  if (true) {
    $.ajaxSetup({cache: true});
    $.getScript('/static/maas-1.9/versions.js', function() {
      console.log( "Versions script loaded." );
      set_up_version_switcher('#version_switcher', 'docs');
    });
}
});
</script>

<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="devices.html" title="previous chapter">Devices</a></li>
      <li>Next: <a href="tags.html" title="next chapter">Making use of Tags</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="/static/maas-1.9/juju-quick-start.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tags.html" title="Making use of Tags"
             >next</a></li>
        <li class="right" >
          <a href="devices.html" title="Devices"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="/maas/">Latest documentation</a>&nbsp;&nbsp;|&nbsp;&nbsp;
  </li>
  <li class="nav-item nav-item-0">
    <a href="index.html">MAAS 1.9 documentation</a>
  </li>
 
      </ul>
    </div>
<footer class="global clearfix">
  <div class="legal clearfix">
    <p>&copy; Copyright 2012-2015, MAAS Developers. Ubuntu and Canonical are registered trademarks of
      <a href="http://canonical.com">Canonical Ltd</a>.
    </p>
    <p>
      Revision 4595
 (2016-08-24 14:59:26 +0000).
      Documentation generation date: 2016-08-24 16:22:23 +0100.
    </p>
  </div>
</footer>
  </body>
</html>